{"timestamp":"2026-01-06T09:59:12.625425Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-01-06T09:59:12.638036Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/test_dag_sahil_fail.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-01-06T09:59:13.239894Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/test_dag_sahil_fail.py","lineno":5,"logger":"py.warnings"}
{"timestamp":"2026-01-06T09:59:13.240162Z","level":"warning","event":"The `airflow.operators.python.get_current_context` attribute is deprecated. Please use `'airflow.sdk.get_current_context'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/test_dag_sahil_fail.py","lineno":5,"logger":"py.warnings"}
{"timestamp":"2026-01-06T09:59:13.279019Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:13.279602Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:13.279892Z","level":"info","event":"Current task name:t1","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:13.280196Z","level":"info","event":"Dag name:test_dag_sahil_fail","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:13.281316Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1008,"error_detail":[{"exc_type":"Exception","exc_value":"Intentional failure for testing failure callback.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":934,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1325,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":417,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":215,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":238,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/test_dag_sahil_fail.py","lineno":13,"name":"always_fail"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-01-06T09:59:13.283770Z","level":"info","event":"DAG FAILURE CALLBACK TRIGGERED for test_dag_sahil_fail","logger":"observability_callbacks","filename":"observability_callbacks.py","lineno":77}
{"timestamp":"2026-01-06T09:59:13.284481Z","level":"info","event":"### OBSERVABILITY CALLBACK ENTERED ###","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:13.305749Z","level":"info","event":"Snowflake Connector for Python Version: 4.0.0, Python Version: 3.12.12, Platform: Linux-5.10.102.1-microsoft-standard-WSL2-x86_64-with-glibc2.36","logger":"snowflake.connector.connection","filename":"connection.py","lineno":586}
{"timestamp":"2026-01-06T09:59:13.306551Z","level":"info","event":"Connecting to GLOBAL Snowflake domain","logger":"snowflake.connector.connection","filename":"connection.py","lineno":1629}
{"timestamp":"2026-01-06T09:59:14.583188Z","level":"info","event":"Running statement: MERGE INTO MONITORING.AIRFLOW_DAG_RUNS t\n    USING (\n        SELECT %s as dag_id,\n               %s as dag_run_id,\n               %s as run_type,\n               %s::timestamp_ntz as execution_date,\n               %s::timestamp_ntz as start_time,\n               %s::timestamp_ntz as end_time,\n               %s as status,\n               current_timestamp() as logged_at\n    ) s\n    ON t.dag_run_id = s.dag_run_id\n    WHEN MATCHED THEN UPDATE SET\n        dag_id = s.dag_id,\n        run_type = s.run_type,\n        execution_date = s.execution_date,\n        start_time = s.start_time,\n        end_time = s.end_time,\n        status = s.status,\n        logged_at = s.logged_at\n    WHEN NOT MATCHED THEN INSERT (dag_id, dag_run_id, run_type, execution_date, start_time, end_time, status, logged_at)\n    VALUES (s.dag_id, s.dag_run_id, s.run_type, s.execution_date, s.start_time, s.end_time, s.status, s.logged_at), parameters: ['test_dag_sahil_fail', 'manual__2026-01-06T09:59:09+00:00', 'manual', '2026-01-06T09:59:09+00:00', '2026-01-06T09:59:11.879239+00:00', None, 'FAILED']","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"snowflake.py","lineno":584}
{"timestamp":"2026-01-06T09:59:14.583373Z","level":"info","event":"Running statement: MERGE INTO MONITORING.AIRFLOW_DAG_RUNS t\n    USING (\n        SELECT %s as dag_id,\n               %s as dag_run_id,\n               %s as run_type,\n               %s::timestamp_ntz as execution_date,\n               %s::timestamp_ntz as start_time,\n               %s::timestamp_ntz as end_time,\n               %s as status,\n               current_timestamp() as logged_at\n    ) s\n    ON t.dag_run_id = s.dag_run_id\n    WHEN MATCHED THEN UPDATE SET\n        dag_id = s.dag_id,\n        run_type = s.run_type,\n        execution_date = s.execution_date,\n        start_time = s.start_time,\n        end_time = s.end_time,\n        status = s.status,\n        logged_at = s.logged_at\n    WHEN NOT MATCHED THEN INSERT (dag_id, dag_run_id, run_type, execution_date, start_time, end_time, status, logged_at)\n    VALUES (s.dag_id, s.dag_run_id, s.run_type, s.execution_date, s.start_time, s.end_time, s.status, s.logged_at), parameters: ['test_dag_sahil_fail', 'manual__2026-01-06T09:59:09+00:00', 'manual', '2026-01-06T09:59:09+00:00', '2026-01-06T09:59:11.879239+00:00', None, 'FAILED']","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"sql.py","lineno":806}
{"timestamp":"2026-01-06T09:59:15.423026Z","level":"info","event":"Rows affected: 1","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"sql.py","lineno":818}
{"timestamp":"2026-01-06T09:59:15.423441Z","level":"info","event":"Rows affected: 1","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"snowflake.py","lineno":597}
{"timestamp":"2026-01-06T09:59:15.423557Z","level":"info","event":"Snowflake query id: 01c18c36-0001-6f4c-000d-20a20002940a","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"snowflake.py","lineno":598}
{"timestamp":"2026-01-06T09:59:15.901154Z","level":"info","event":"Upserted DAG run test_dag_sahil_fail / manual__2026-01-06T09:59:09+00:00 into MONITORING.AIRFLOW_DAG_RUNS","logger":"observability_callbacks","filename":"observability_callbacks.py","lineno":66}
{"timestamp":"2026-01-06T09:59:15.902161Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:15.903363Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:15.904391Z","level":"info","event":"Task:<Task(PythonOperator): t1>","logger":"task.stdout"}
{"timestamp":"2026-01-06T09:59:15.904867Z","level":"info","event":"Failure caused by Intentional failure for testing failure callback.","logger":"task.stdout"}
